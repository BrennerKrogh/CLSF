(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[195],{3422:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>g});var a=s(5155),t=s(2115),l=s(759);function o(e){let{onSearch:r,onReset:s}=e,[l,o]=(0,t.useState)(""),[i,n]=(0,t.useState)("");return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 md:p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Find the perfect study group"}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),console.log("Search params:",{subject:l,location:i}),r({subject:l,location:i})},className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-1",children:[(0,a.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),(0,a.jsxs)("select",{id:"subject",value:l,onChange:e=>o(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-700 rounded-lg dark:bg-gray-800",children:[(0,a.jsx)("option",{value:"",children:"All Subjects"}),(0,a.jsx)("option",{value:"Computer Science",children:"Computer Science"}),(0,a.jsx)("option",{value:"Mathematics",children:"Mathematics"}),(0,a.jsx)("option",{value:"Physics",children:"Physics"}),(0,a.jsx)("option",{value:"Chemistry",children:"Chemistry"}),(0,a.jsx)("option",{value:"Biology",children:"Biology"}),(0,a.jsx)("option",{value:"English",children:"English"}),(0,a.jsx)("option",{value:"History",children:"History"}),(0,a.jsx)("option",{value:"Psychology",children:"Psychology"}),(0,a.jsx)("option",{value:"Engineering",children:"Engineering"}),(0,a.jsx)("option",{value:"Economics",children:"Economics"}),(0,a.jsx)("option",{value:"Art",children:"Art"}),(0,a.jsx)("option",{value:"Music",children:"Music"}),(0,a.jsx)("option",{value:"Philosophy",children:"Philosophy"}),(0,a.jsx)("option",{value:"Sociology",children:"Sociology"})]})]}),(0,a.jsxs)("div",{className:"col-span-1",children:[(0,a.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Location"}),(0,a.jsxs)("select",{id:"location",value:i,onChange:e=>n(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-700 rounded-lg dark:bg-gray-800",children:[(0,a.jsx)("option",{value:"",children:"All Locations"}),(0,a.jsx)("option",{value:"McHenry Library",children:"McHenry Library"}),(0,a.jsx)("option",{value:"Science & Engineering Library",children:"Science & Engineering Library"}),(0,a.jsx)("option",{value:"Coffee Shops",children:"Coffee Shops"}),(0,a.jsx)("option",{value:"Student Center",children:"Student Center"}),(0,a.jsx)("option",{value:"Online",children:"Online"}),(0,a.jsx)("option",{value:"Residence Halls",children:"Residence Halls"}),(0,a.jsx)("option",{value:"Study Rooms",children:"Study Rooms"}),(0,a.jsx)("option",{value:"Campus",children:"Campus"}),(0,a.jsx)("option",{value:"Off Campus",children:"Off Campus"})]})]}),(0,a.jsxs)("div",{className:"col-span-1 flex flex-col space-y-2",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 p-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition",children:"Search Groups"}),(0,a.jsx)("button",{type:"button",onClick:()=>{o(""),n(""),s()},className:"flex-1 p-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-medium rounded-lg transition",children:"Reset Filters"})]})]})})]})}var i=s(9670);function n(e){let{group:r,onGroupUpdate:s}=e,[l,o]=(0,t.useState)(!1),[n,d]=(0,t.useState)(r),[c,g]=(0,t.useState)(!1),[u,x]=(0,t.useState)(null),[m,h]=(0,t.useState)([]),p=n.joined>=n.capacity,b=async e=>{try{let r=await (0,i.Bt)(n.id,e);g(r)}catch(e){console.error("Error checking user group status:",e)}};(0,t.useEffect)(()=>{(async()=>{if(n.members&&n.members.length>0)try{let e=await Promise.all(n.members.map(e=>(0,i.TO)(e)));h(e)}catch(e){console.error("Error fetching member usernames:",e),h([])}else h([])})()},[n.members]),(0,t.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{e?(x(e.uid),b(e.uid)):(x(null),g(!1))});return()=>e()},[b]),(0,t.useEffect)(()=>{d(r),u&&b(u)},[r,u]);let y=async()=>{if(!u)return void alert("Please sign in to join a group");if(!c&&!p){o(!0);try{let e=await (0,i.U7)(n.id,u);d(e),g(!0),s&&s(e),console.log("Successfully joined group: ".concat(n.id))}catch(r){console.error("Error joining group:",r);let e=r instanceof Error?r.message:"Failed to join group. Please try again.";alert("Failed to join group: ".concat(e))}finally{o(!1)}}},j=u?c?{disabled:!0,text:"Group Joined",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 cursor-not-allowed"}:p?{disabled:!0,text:"Group Full",className:"bg-gray-300 text-gray-500 dark:bg-gray-700 dark:text-gray-400 cursor-not-allowed"}:{disabled:!1,text:"Join Group",className:"bg-purple-600 text-white hover:bg-purple-700"}:{disabled:!0,text:"Sign In to Join",className:"bg-gray-300 text-gray-500 dark:bg-gray-700 dark:text-gray-400 cursor-not-allowed"};return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-lg transition duration-200",children:[(0,a.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200 rounded-md mb-2",children:n.subject}),(0,a.jsx)("h3",{className:"text-lg font-semibold line-clamp-1",children:n.name})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:(0,a.jsxs)("span",{className:p?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",children:[n.joined,"/",n.capacity]})})})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300 text-sm line-clamp-2",children:n.description}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Created by ",(0,a.jsx)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:n.creator})]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 line-clamp-1",children:n.location})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:n.dateTime})]}),m.length>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("span",{className:"font-medium",children:"Members:"})," ",m.join(", ")]})]}),(0,a.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsx)("button",{onClick:y,disabled:j.disabled||l,className:"w-full py-2 px-4 rounded-md text-sm font-medium transition ".concat(j.className),children:l?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Joining..."]}):j.text})})]})}function d(e){let{searchFilters:r,shouldRefresh:s,onRefreshComplete:l}=e,[o,d]=(0,t.useState)([]),[c,g]=(0,t.useState)([]),[u,x]=(0,t.useState)(!0),[m,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{h(e?e.uid:null)});return()=>e()},[]),(0,t.useEffect)(()=>{p()},[]),(0,t.useEffect)(()=>{null!==m&&p()},[m]),(0,t.useEffect)(()=>{s&&(p(),l&&l())},[s,l]),(0,t.useEffect)(()=>{b()},[r,o]);let p=async()=>{try{x(!0);let e=((await (0,i.ww)()||[]).filter(e=>e.members&&e.members.length>0)||[]).filter(e=>!0===e.isPublic);d(e||[]),console.log("Loaded groups:",e)}catch(e){console.error("Error fetching groups:",e)}finally{x(!1)}},b=()=>{if(!r||!r.subject&&!r.location)return void g(o);let e=o.filter(e=>{let s=!r.subject||e.subject.toLowerCase().includes(r.subject.toLowerCase()),a=!r.location||e.location.toLowerCase().includes(r.location.toLowerCase());return s&&a});g(e),console.log("Applied filters:",r,"Results:",e.length)},y=e=>{console.log("Updating group in list:",e),d(r=>r.map(r=>r.id===e.id?e:r)),setTimeout(()=>{p()},1e3)},j=r&&(r.subject||r.location);return u?(0,a.jsxs)("div",{className:"pb-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Available Study Groups"}),(0,a.jsx)("div",{className:"w-20 h-4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 animate-pulse",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("div",{className:"w-20 h-4 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),(0,a.jsx)("div",{className:"w-full h-6 bg-gray-300 dark:bg-gray-600 rounded"})]}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsx)("div",{className:"w-full h-4 bg-gray-300 dark:bg-gray-600 rounded"}),(0,a.jsx)("div",{className:"w-3/4 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),(0,a.jsx)("div",{className:"w-1/2 h-4 bg-gray-300 dark:bg-gray-600 rounded"})]}),(0,a.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsx)("div",{className:"w-full h-8 bg-gray-300 dark:bg-gray-600 rounded"})})]},e))})]}):(0,a.jsxs)("div",{className:"pb-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:j?"Filtered Study Groups":"Available Study Groups"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[c.length," group",1!==c.length?"s":""," found",j&&" (".concat(o.length," total)")]}),(0,a.jsx)("button",{onClick:()=>{console.log("Manual refresh triggered"),p()},className:"text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 text-sm",children:"Refresh"})]})]}),j&&(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-blue-800 dark:text-blue-400 text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Active filters:"}),(null==r?void 0:r.subject)&&" Subject: ".concat(r.subject),(null==r?void 0:r.subject)&&(null==r?void 0:r.location)&&", ",(null==r?void 0:r.location)&&" Location: ".concat(r.location)]})}),0===c.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:j?"No groups match your filters":"No study groups found"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Try adjusting your search filters or create a new group."})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(e=>(0,a.jsx)(n,{group:e,onGroupUpdate:y},e.id))})]})}var c=s(2137);function g(){let[e,r]=(0,t.useState)(void 0),[s,i]=(0,t.useState)(!1);return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen p-4 md:p-6 max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Find Study Groups"}),(0,a.jsx)("p",{className:"text-lg mb-6",children:"Join a study group to collaborate with classmates and improve your academic performance."}),(0,a.jsx)(c.default,{}),(0,a.jsx)(o,{onSearch:e=>{console.log("Applying search filters:",e),r(e)},onReset:()=>{console.log("Resetting filters"),r(void 0),i(!0)}}),(0,a.jsx)(d,{searchFilters:e,shouldRefresh:s,onRefreshComplete:()=>{i(!1)}}),(0,a.jsx)("div",{className:"h-16"}),(0,a.jsx)(l.default,{})]})}},8741:(e,r,s)=>{Promise.resolve().then(s.bind(s,3422))}},e=>{var r=r=>e(e.s=r);e.O(0,[507,965,463,244,879,441,684,358],()=>r(8741)),_N_E=e.O()}]);