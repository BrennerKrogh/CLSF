(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1494:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(5155),o=t(2115),n=t(9670),a=t(6203);let l=()=>{let[e,r]=(0,o.useState)(""),[t,a]=(0,o.useState)(""),l=async r=>{r.preventDefault();try{await (0,n.xw)(e),a("Password reset email sent.")}catch(e){console.error(e),a("Failed to send reset email.")}};return(0,s.jsxs)("form",{onSubmit:l,className:"flex flex-col gap-4",children:[(0,s.jsx)("input",{type:"email",placeholder:"Enter your email",className:"border p-2 rounded",value:e,onChange:e=>r(e.target.value),required:!0}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Reset Password"}),t&&(0,s.jsx)("p",{children:t})]})};function i(){let[e,r]=(0,o.useState)(""),[t,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[d,g]=(0,o.useState)("login"),[m,p]=(0,o.useState)(!1),[h,x]=(0,o.useState)(!1),b=async r=>{r.preventDefault(),x(!0),u("");try{await (0,a.eJ)(n.j2,e,t),window.location.href="/account?edit=true"}catch(e){e instanceof Error?u(e.message):u("An unknown error occurred.")}finally{x(!1)}},f=async r=>{r.preventDefault(),x(!0),u("");try{await (0,a.x9)(n.j2,e,t),window.location.href="/home"}catch(e){e instanceof Error?u(e.message):u("An unknown error occurred."),p(!0)}finally{x(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-purple-600 clip-triangle mx-auto mb-4"}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Study Group Finder"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"signup"===d?"Create your account":"Welcome back"})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"signup"===d?"Sign Up":"Sign In"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"signup"===d?"Join our community of students":"Enter your credentials to continue"})]}),(0,s.jsxs)("form",{onSubmit:"signup"===d?b:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address"}),(0,s.jsx)("input",{id:"email",type:"email",placeholder:"Enter your email",value:e,required:!0,onChange:e=>r(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition duration-200"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),(0,s.jsx)("input",{id:"password",type:"password",placeholder:"Enter your password",value:t,required:!0,onChange:e=>i(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition duration-200"})]}),c&&(0,s.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,s.jsx)("p",{className:"text-red-700 dark:text-red-400 text-sm",children:c})}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-medium py-3 px-4 rounded-lg transition duration-200 flex items-center justify-center",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"signup"===d?"Creating Account...":"Signing In..."]}):"signup"===d?"Create Account":"Sign In"})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["signup"===d?"Already have an account?":"Don't have an account?"," ",(0,s.jsx)("button",{onClick:()=>{g(e=>"signup"===e?"login":"signup"),u(""),p(!1)},className:"text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 font-medium transition duration-200",children:"signup"===d?"Sign In":"Sign Up"})]})}),m&&"login"===d&&(0,s.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-400 mb-2",children:"Forgot your password?"}),(0,s.jsx)("p",{className:"text-blue-700 dark:text-blue-300 text-sm mb-3",children:"No worries! Enter your email below to reset it."}),(0,s.jsx)(l,{})]})})]})]})})}},2540:(e,r,t)=>{Promise.resolve().then(t.bind(t,1494))},9670:(e,r,t)=>{"use strict";t.d(r,{Bt:()=>f,DY:()=>c,U7:()=>b,Yh:()=>p,cD:()=>d,db:()=>i,j:()=>y,j2:()=>l,lP:()=>h,lw:()=>w,uy:()=>x,ww:()=>g,xw:()=>m,ys:()=>u});var s=t(3915),o=t(6203),n=t(1115);let a=(0,s.Wp)({apiKey:"AIzaSyCHRw0E0QyJdCKg3x6110qcCv6CN0aSpm0",authDomain:"clsf-100903.firebaseapp.com",projectId:"clsf-100903",databaseURL:"https://clsf-100903-default-rtdb.firebaseio.com",storageBucket:"clsf-100903.firebasestorage.com",messagingSenderId:"771126443973",appId:"1:771126443973:web:65bb6d3e4a5205336a15ac",measurementId:"G-S72EE3YEDX"}),l=(0,o.xI)(a);(0,o.hg)(l,e=>{e&&e.uid});let i=(0,n.C3)(a);function c(){let e=(0,o.xI)().currentUser;e?console.log("Email:",e.email):console.log("No user signed in"),console.log("Pinging backend...");let r=(0,n.KR)(i,"ping");(0,n.hZ)(r,{timestamp:Date.now()}).then(()=>{console.log("Ping successful")}).catch(e=>{console.error("Ping failed:",e)})}function u(e,r){let t=(0,n.KR)(i,"users/"+e);return(0,n.hZ)(t,r).then(()=>{console.log("Data added successfully")}).catch(e=>{console.error("Error adding data:",e)})}function d(e,r){let t=(0,o.xI)().currentUser,s=t.email,a=(0,n.KR)(i,"studyGroups/"+e),l={...r,creator:s,members:[t.uid],joined:1};return(0,n.hZ)(a,l).then(()=>(console.log("Study group data added successfully"),{id:e,...l})).catch(e=>{throw console.error("Error adding study group data:",e),e})}function g(){let e=(0,n.KR)(i,"studyGroups/");return(0,n.Jt)(e).then(e=>e.exists()?Object.entries(e.val()).map(e=>{let[r,t]=e;return{id:r,...t}}):(console.log("No groups found"),[])).catch(e=>(console.error("Error fetching groups:",e),[]))}function m(e){return(0,o.J1)(l,e).then(()=>{console.log("Password reset email sent!")}).catch(e=>{console.error("Error sending password reset email:",e)})}function p(e,r){let t=(0,n.KR)(i,"users/".concat(e,"/profile"));return(0,n.hZ)(t,r)}function h(e){let r=(0,n.KR)(i,"users/".concat(e,"/profile"));return(0,n.Jt)(r).then(e=>e.exists()?e.val():null)}function x(){let e=(0,o.xI)().currentUser;if(!e)return console.log("No user signed in for fetchGroupsByUID"),Promise.resolve([]);let r=e.uid;console.log("Fetching groups for user:",r);let t=(0,n.KR)(i,"studyGroups");return(0,n.Jt)(t).then(e=>{if(!e.exists())return console.log("No study groups available"),[];{let t=e.val();console.log("All groups from Firebase:",t);let s=Object.keys(t).map(e=>({id:e,...t[e]})).filter(e=>{let t=Array.isArray(e.members)?e.members:[],s=t.includes(r);return console.log("Group ".concat(e.id,": members ="),t,"user ".concat(r," in group:"),s),s});return console.log("Filtered user groups:",s),s}}).catch(e=>(console.error("Error fetching study groups:",e),[]))}(0,o.oM)(l,o.F0).then(()=>{console.log("Session persistence set to local.")}).catch(e=>{console.error("Error setting session persistence:",e)}),(0,o.hg)(l,e=>{e?console.log("User is signed in:",e.uid):console.log("User is signed out.")});function b(e,r){console.log("Attempting to join group:",e,"with user:",r);let t=(0,n.KR)(i,"studyGroups/".concat(e));return(0,n.Jt)(t).then(s=>{if(s.exists()){let o=s.val();console.log("Found group data:",o);let a=Array.isArray(o.members)?o.members:[];if(a.includes(r))throw Error("User is already in this group");if((o.joined||a.length)>=o.capacity)throw Error("Group is full");let l=[...a,r],i={...o,members:l,joined:l.length};return(0,n.hZ)(t,i).then(()=>(console.log("Successfully joined group:",e),{id:e,...i}))}throw console.log("Group not found in Firebase:",e),Error("Group not found")}).catch(e=>{throw console.error("Error joining group:",e),e})}function f(e,r){let t=(0,n.KR)(i,"studyGroups/".concat(e));return(0,n.Jt)(t).then(e=>{if(!e.exists())return!1;{let t=e.val();return(Array.isArray(t.members)?t.members:[]).includes(r)}}).catch(e=>(console.error("Error checking user group status:",e),!1))}function y(e,r){console.log("Attempting to leave group:",e,"with user:",r);let t=(0,n.KR)(i,"studyGroups/".concat(e));return(0,n.Jt)(t).then(s=>{if(s.exists()){let o=s.val();console.log("Found group data for leaving:",o);let a=Array.isArray(o.members)?o.members:[];if(console.log("Current members:",a),!a.includes(r))throw Error("User is not in this group");let l=a.filter(e=>e!==r);console.log("Updated members after removal:",l);let i={...o,members:l,joined:l.length};return(0,n.hZ)(t,i).then(()=>(console.log("Successfully left group:",e),{id:e,...i}))}throw console.log("Group not found in Firebase when trying to leave:",e),Error("Group not found")}).catch(e=>{throw console.error("Error leaving group:",e),e})}async function w(){let e=l.currentUser;if(e)await (0,o.hG)(e);else throw Error("No user is currently logged in.")}t.e(864).then(t.bind(t,6864)).then(e=>{let{getAnalytics:r}=e;r(a)})}},e=>{var r=r=>e(e.s=r);e.O(0,[507,965,463,441,684,358],()=>r(2540)),_N_E=e.O()}]);